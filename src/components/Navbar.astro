---
// src/components/Navbar.astro

// 1. Tipado
interface MenuItem {
  name: string;
  href: string;
}

interface Translation {
  menu: MenuItem[];
  langLabel: string; 
}

// 2. Configuración i18n
const i18n: Record<string, Translation> = {
  es: {
    menu: [
      { name: 'Inicio', href: '/' },
      { name: 'Escritor', href: '/escritor' },
      { name: 'Artista', href: '/artista' },
    ],
    langLabel: 'EN' 
  },
  en: {
    menu: [
      { name: 'Home', href: '/en' },
      { name: 'Writer', href: '/en/writer' },
      { name: 'Artist', href: '/en/artist' },
    ],
    langLabel: 'ES'
  }
};

// 3. Datos actuales
const currentLocale = Astro.currentLocale || 'es';
const t = i18n[currentLocale] || i18n['es'];

// 4. Lógica de Ruteo
const routeMap: Record<string, string> = {
  '/': '/en',
  '/escritor': '/en/writer',
  '/artista': '/en/artist',
  '/en': '/',
  '/en/': '/', 
  '/en/writer': '/escritor',
  '/en/artist': '/artista',
};

const currentPath = Astro.url.pathname.replace(/\/$/, "") || "/";
const targetLangHome = currentLocale === 'es' ? '/en' : '/';
const translatedPath = routeMap[currentPath] || targetLangHome;
---

<header class="sticky top-0 w-full z-50 transition-all duration-300 bg-black/50 backdrop-blur-md border-b border-white/5">
  
  {/* py-3 permite que la altura se ajuste automáticamente a las dos lineas en móvil */}
  <div class="max-w-7xl mx-auto px-6 py-3 md:py-0 md:h-20 flex items-center justify-center relative">

    {/* ESTRUCTURA PRINCIPAL:
        - Mobile: flex-col (Columna) -> Pone los enlaces arriba y el idioma abajo.
        - Desktop: flex-row (Fila) -> Pone todo en una sola línea.
    */}
    <nav class="flex flex-col md:flex-row items-center gap-3 md:gap-10">
      
      {/* GRUPO 1: ENLACES
          - flex-row: ¡Clave! Fuerza a que los enlaces estén siempre lado a lado (horizontal),
            incluso en móvil.
      */}
      <ul class="flex flex-row items-center gap-6 md:gap-10 list-none m-0 p-0">
        {t.menu.map((item) => (
          <li>
            <a 
              href={item.href}
              class="text-xs md:text-sm font-medium uppercase tracking-[0.2em] text-gray-400 hover:text-white transition-colors duration-300"
            >
              {item.name}
            </a>
          </li>
        ))}
      </ul>

      {/* SEPARADOR (Solo visible en Desktop) */}
      <div class="hidden md:block h-4 w-px bg-white/20"></div>

      {/* GRUPO 2: IDIOMA
          - Al estar fuera del <ul> anterior, en móvil cae a la siguiente línea
            gracias al flex-col del padre (<nav>).
      */}
      <div class="flex items-center gap-2 text-xs md:text-sm font-bold uppercase tracking-widest text-white">
        {currentLocale === 'en' ? (
          <span class="text-accent cursor-default">EN</span>
        ) : (
          <a href={translatedPath} class="hover:text-accent transition-colors duration-300">EN</a>
        )}

        <span class="opacity-50">|</span>

        {currentLocale === 'es' ? (
          <span class="text-accent cursor-default">ES</span>
        ) : (
          <a href={translatedPath} class="hover:text-accent transition-colors duration-300">ES</a>
        )}
      </div>

    </nav>

  </div>
</header>